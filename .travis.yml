language: python
matrix:
  include:
  - name: Python 3.7 on Linux
    python: 3.7
    before_install:
    - sed -i 's/<expat.h>/"expat.h"/' gym_jsbsim/jsbsim/src/simgear/xml/easyxml.cxx
    - sed -i 's/std::min/(std::min)/' gym_jsbsim/jsbsim/src/simgear/misc/strutils.cxx
  - name: Python 3.7 on macOS
    os: osx
    osx_image: xcode11
    language: shell
  - name: Python 3.7 on Windows
    os: windows
    language: shell
    before_install:
    - choco install python --version=3.7.4
    - python -m pip install --upgrade pip
    - pip install https://download.lfd.uci.edu/pythonlibs/g5apjq5m/Shapely-1.6.4.post2-cp37-cp37m-win_amd64.whl
    - sed -i 's/<expat.h>/"expat.h"/' gym_jsbsim/jsbsim/src/simgear/xml/easyxml.cxx
    - sed -i 's/std::min/(std::min)/' gym_jsbsim/jsbsim/src/simgear/misc/strutils.cxx
    env: PATH=/c/Python37:/c/Python37/Scripts:$PATH
install:
- pip3 install .
script:
- python3 -m unittest || python -m unittest
after_success:
- pip3 install wheel twine
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then chmod +x build_wheels.sh && docker run
  --rm -v $PWD:/io quay.io/pypa/manylinux2010_x86_64 /io/build_wheels.sh && ls dist/;
  fi
deploy:
  provider: script
  script: sh ./deploy.sh
  skip_existing: true
  skip_cleanup: true
  on:
    branch: new
env:
  global:
    secure: V10MHKTKlLBK8sIsvZfr+lWhkLR7zd0xn4kZ4C0HB5T3COA5TOYbJWrNE3AxW5B59Hp8ZMYPYsM9tpGyBG5BCORH8W1a2vMSa4Zud0+D4IExiqiFrNScWC70Ymu6fRMC15OQlJ2oyb1luCAsOCaoogLBYkj54mOlRj4k8Sz87lXqq2HZ0+8ztSXGVIEdBcQTi8r+24gOYmsJZ4m0C4qkEkG0fhFGDrJD1eMxGK4+23yyfmDxqjkZj74LWwYU1ltacesUbA6H04GOxpQ0eepF5sdOo55s6inCoeUMrp/Hr/+/P0HTn6pY51UaluzY13aDvSA7lPS3YZbwJho7h4izLN/8qVx12LlK1Au2h7oCXCPbNDrEJwMiUhnwfStL9UqOm1DwpMU384ak+FxtIMqJ3LqwItzYNQEauqfT6PmDjwe95abqXK2Gj5NDjGJWJRBffAsx/9eFfyxCU0qH5w1er5WSp0xXwDtFLmXox04c09tZ0VH4ce4JmVdG9O/EhtoPoPdnI5clZWglux7ZOsg/9OnznHdk6XfsSsNhqCxrveNMprZw3XAZpu0i3jH+lm6d3wcmNOdx8ceLlYznlcUIxDjx8DN9SPSzzIs4Y3Zq7Vaf561DwISqhyA9V+r+exqd5gN1LCOlxRbpliobuU4X05qMppJEFyBZptj4PybhuZI=
